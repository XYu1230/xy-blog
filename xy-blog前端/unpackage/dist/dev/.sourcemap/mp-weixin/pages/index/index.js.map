{"version":3,"file":"index.js","sources":["pages/index/index.vue","../../tools/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- 列表下拉刷新 -->\r\n\t\t<view class=\"refresh-tip\" v-if=\"isRefreshing\">\r\n\t\t\t<text class=\"refresh-text\">刷新中...</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 博客列表 -->\r\n\t\t<view class=\"blog-list\">\r\n\t\t\t<view \r\n\t\t\t\tclass=\"blog-item card\" \r\n\t\t\t\tv-for=\"(item, index) in blogList\" \r\n\t\t\t\t:key=\"index\"\r\n\t\t\t\t@click=\"goToBlogDetail(item.id)\"\r\n\t\t\t>\r\n\t\t\t\t<view class=\"blog-header flex-row space-between align-center\">\r\n\t\t\t\t\t<view class=\"blog-author flex-row align-center\">\r\n\t\t\t\t\t\t<image :src=\"item.author.avatar || '/static/default-avatar.png'\" class=\"author-avatar\"></image>\r\n\t\t\t\t\t\t<text class=\"author-name\">{{item.author.nickname}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<text class=\"blog-time\">{{formatTime(item.createTime)}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"blog-content\">\r\n\t\t\t\t\t<text class=\"blog-title\">{{item.title}}</text>\r\n\t\t\t\t\t<text class=\"blog-summary\">{{item.summary}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"blog-footer flex-row space-between align-center\">\r\n\t\t\t\t\t<view class=\"blog-stats flex-row align-center\" @click.stop=\"handleLike(item)\">\r\n\t\t\t\t\t\t<text class=\"iconfont\" :class=\"item.isLiked ? 'icon-like-filled' : 'icon-like'\"></text>\r\n\t\t\t\t\t\t<text class=\"stat-count\">{{item.likeCount || 0}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"stat-item flex-row align-center\">\r\n\t\t\t\t\t\t<text class=\"iconfont icon-comment\"></text>\r\n\t\t\t\t\t\t<text class=\"stat-count\">{{item.commentCount || 0}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 加载更多 -->\r\n\t\t\t<view class=\"load-more\" v-if=\"hasMoreData\">\r\n\t\t\t\t<text @click=\"loadMore\" class=\"load-more-text\">加载更多</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"no-more\" v-else>\r\n\t\t\t\t<text class=\"no-more-text\">没有更多数据了</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 暂无数据提示 -->\r\n\t\t<view class=\"empty-container\" v-if=\"blogList.length === 0 && !isLoading\">\r\n\t\t\t<image src=\"/static/empty.png\" mode=\"aspectFit\" class=\"empty-icon\"></image>\r\n\t\t\t<text class=\"empty-text\">暂无博客，快来发布第一篇吧</text>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport { blogApi } from '@/api/index.js';\r\n\t\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tblogList: [],\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tpageSize: 10,\r\n\t\t\t\thasMoreData: true,\r\n\t\t\t\tisLoading: false,\r\n\t\t\t\tisRefreshing: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tthis.fetchBlogs();\r\n\t\t},\r\n\t\t// 下拉刷新\r\n\t\tonPullDownRefresh() {\r\n\t\t\tthis.isRefreshing = true;\r\n\t\t\tthis.page = 1;\r\n\t\t\tthis.fetchBlogs(true).then(() => {\r\n\t\t\t\tuni.stopPullDownRefresh();\r\n\t\t\t\tthis.isRefreshing = false;\r\n\t\t\t}).catch(() => {\r\n\t\t\t\tuni.stopPullDownRefresh();\r\n\t\t\t\tthis.isRefreshing = false;\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 上拉加载更多\r\n\t\tonReachBottom() {\r\n\t\t\tif (this.hasMoreData && !this.isLoading) {\r\n\t\t\t\tthis.loadMore();\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 获取博客列表\r\n\t\t\tasync fetchBlogs(isRefresh = false) {\r\n\t\t\t\tthis.isLoading = true;\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst res = await blogApi.getBlogs(this.page, this.pageSize);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (isRefresh) {\r\n\t\t\t\t\t\tthis.blogList = res.data.data || [];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.blogList = [...this.blogList, ...(res.data.data || [])];\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 判断是否还有更多数据\r\n\t\t\t\t\tthis.hasMoreData = (res.data.data && res.data.data.length === this.pageSize);\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('获取博客列表失败:', error);\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tthis.isLoading = false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 加载更多\r\n\t\t\tloadMore() {\r\n\t\t\t\tif (this.isLoading) return;\r\n\t\t\t\tthis.page++;\r\n\t\t\t\tthis.fetchBlogs();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 跳转到博客详情页\r\n\t\t\tgoToBlogDetail(id) {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: `/pages/detail/detail?id=${id}`\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 处理点赞\r\n\t\t\tasync handleLike(blog) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (blog.isLiked) {\r\n\t\t\t\t\t\t// 已点赞，取消点赞\r\n\t\t\t\t\t\tawait blogApi.unlikeBlog(blog.id);\r\n\t\t\t\t\t\tblog.isLiked = false;\r\n\t\t\t\t\t\tblog.likeCount = Math.max(0, (blog.likeCount || 1) - 1);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// 未点赞，添加点赞\r\n\t\t\t\t\t\tawait blogApi.likeBlog(blog.id);\r\n\t\t\t\t\t\tblog.isLiked = true;\r\n\t\t\t\t\t\tblog.likeCount = (blog.likeCount || 0) + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('点赞操作失败:', error);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 格式化时间\r\n\t\t\tformatTime(timestamp) {\r\n\t\t\t\tif (!timestamp) return '';\r\n\t\t\t\t\r\n\t\t\t\tconst date = new Date(timestamp);\r\n\t\t\t\tconst now = new Date();\r\n\t\t\t\tconst diff = now - date;\r\n\t\t\t\t\r\n\t\t\t\t// 计算时间差\r\n\t\t\t\tconst minute = 60 * 1000;\r\n\t\t\t\tconst hour = 60 * minute;\r\n\t\t\t\tconst day = 24 * hour;\r\n\t\t\t\t\r\n\t\t\t\t// 小于1分钟\r\n\t\t\t\tif (diff < minute) {\r\n\t\t\t\t\treturn '刚刚';\r\n\t\t\t\t}\r\n\t\t\t\t// 小于1小时\r\n\t\t\t\tif (diff < hour) {\r\n\t\t\t\t\treturn Math.floor(diff / minute) + '分钟前';\r\n\t\t\t\t}\r\n\t\t\t\t// 小于1天\r\n\t\t\t\tif (diff < day) {\r\n\t\t\t\t\treturn Math.floor(diff / hour) + '小时前';\r\n\t\t\t\t}\r\n\t\t\t\t// 小于30天\r\n\t\t\t\tif (diff < 30 * day) {\r\n\t\t\t\t\treturn Math.floor(diff / day) + '天前';\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 超过30天显示具体日期\r\n\t\t\t\tconst year = date.getFullYear();\r\n\t\t\t\tconst month = (date.getMonth() + 1).toString().padStart(2, '0');\r\n\t\t\t\tconst dayStr = date.getDate().toString().padStart(2, '0');\r\n\t\t\t\treturn `${year}-${month}-${dayStr}`;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.container {\r\n\t\tpadding: 20rpx;\r\n\t\tbackground-color: #f5f5f5;\r\n\t\tmin-height: 100vh;\r\n\t}\r\n\t\r\n\t.refresh-tip {\r\n\t\ttext-align: center;\r\n\t\tpadding: 10rpx 0;\r\n\t\tcolor: #999;\r\n\t\tfont-size: 26rpx;\r\n\t}\r\n\t\r\n\t.blog-list {\r\n\t\twidth: 100%;\r\n\t}\r\n\t\r\n\t.blog-item {\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.blog-header {\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.blog-author {\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\t\r\n\t.author-avatar {\r\n\t\twidth: 60rpx;\r\n\t\theight: 60rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\t\r\n\t.author-name {\r\n\t\tcolor: #333;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\t\r\n\t.blog-time {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t.blog-content {\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.blog-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-bottom: 10rpx;\r\n\t\tdisplay: block;\r\n\t}\r\n\t\r\n\t.blog-summary {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t\tdisplay: block;\r\n\t\tline-height: 1.5;\r\n\t\tdisplay: -webkit-box;\r\n\t\t-webkit-line-clamp: 3;\r\n\t\t-webkit-box-orient: vertical;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t}\r\n\t\r\n\t.blog-footer {\r\n\t\tborder-top: 1px solid #eee;\r\n\t\tpadding-top: 20rpx;\r\n\t}\r\n\t\r\n\t.stat-item {\r\n\t\tmargin-right: 30rpx;\r\n\t}\r\n\t\r\n\t.iconfont {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t.icon-like-filled {\r\n\t\tcolor: #FF6B6B;\r\n\t}\r\n\t\r\n\t.stat-count {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999;\r\n\t\tmargin-left: 6rpx;\r\n\t}\r\n\t\r\n\t.blog-tags {\r\n\t\tdisplay: flex;\r\n\t\tflex-wrap: wrap;\r\n\t}\r\n\t\r\n\t.tag {\r\n\t\tpadding: 6rpx 16rpx;\r\n\t\tbackground-color: #f0f8ff;\r\n\t\tcolor: #007AFF;\r\n\t\tborder-radius: 30rpx;\r\n\t\tfont-size: 22rpx;\r\n\t\tmargin-left: 10rpx;\r\n\t}\r\n\t\r\n\t.load-more, .no-more {\r\n\t\ttext-align: center;\r\n\t\tpadding: 30rpx 0;\r\n\t}\r\n\t\r\n\t.load-more-text {\r\n\t\tcolor: #007AFF;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\t\r\n\t.no-more-text {\r\n\t\tcolor: #999;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\t\r\n\t.empty-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding-top: 200rpx;\r\n\t}\r\n\t\r\n\t.empty-icon {\r\n\t\twidth: 200rpx;\r\n\t\theight: 200rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.empty-text {\r\n\t\tcolor: #999;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n</style>\r\n","import MiniProgramPage from 'D:/Hbuilder项目/myblog/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","blogApi"],"mappings":"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"}